---
title: "サーバー稼働状況"
---

研究室の計算サーバーの稼働状況をリアルタイムで確認できます。

<p style="text-align: center; font-size: 1.2rem; font-weight: bold; margin: 1.5rem 0;">
最終更新: <span id="last-update-note">読み込み中...</span>
</p>

```{=html}
<style>
.server-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.5rem;
  margin: 2rem 0;
}

.server-card {
  background: var(--bs-body-bg);
  border: 1px solid var(--bs-border-color);
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.server-card.offline {
  opacity: 0.6;
}

.server-name {
  font-size: 1.25rem;
  font-weight: bold;
  margin-bottom: 0.5rem;
}

.server-status {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.25rem 0.75rem;
  border-radius: 20px;
  font-size: 0.875rem;
  margin-bottom: 1rem;
}

.status-online {
  background: #d4edda;
  color: #155724;
}

.status-offline {
  background: #f8d7da;
  color: #721c24;
}

.status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
}

.status-dot.online {
  background: #28a745;
}

.status-dot.offline {
  background: #dc3545;
}

.server-specs {
  font-size: 0.875rem;
  color: var(--bs-secondary-color);
  margin-bottom: 1rem;
}

.metrics {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.75rem;
}

.metric {
  text-align: center;
}

.metric-value {
  font-size: 1.5rem;
  font-weight: bold;
  color: var(--bs-emphasis-color);
}

.metric-label {
  font-size: 0.75rem;
  color: var(--bs-secondary-color);
  text-transform: uppercase;
}

.update-time {
  text-align: center;
  color: var(--bs-secondary-color);
  font-size: 0.875rem;
  margin-top: 2rem;
}

.loading {
  text-align: center;
  padding: 3rem;
  color: var(--bs-secondary-color);
}
</style>

<div id="server-dashboard">
  <div class="loading">読み込み中...</div>
</div>

<div id="update-time" class="update-time"></div>

<script>
async function loadServerStatus() {
  try {
    const response = await fetch('server_status.json?' + Date.now());
    const data = await response.json();
    renderDashboard(data);
  } catch (error) {
    document.getElementById('server-dashboard').innerHTML =
      '<div class="loading">サーバー情報を取得できませんでした</div>';
  }
}

function renderDashboard(data) {
  const container = document.getElementById('server-dashboard');
  const servers = data.servers;

  let html = '<div class="server-grid">';

  servers.forEach(server => {
    const isOnline = server.status === 'online';
    const statusClass = isOnline ? 'online' : 'offline';
    const statusText = isOnline ? '稼働中' : '停止中';

    html += `
      <div class="server-card ${isOnline ? '' : 'offline'}">
        <div class="server-name">${server.name}</div>
        <div class="server-status status-${statusClass}">
          <span class="status-dot ${statusClass}"></span>
          ${statusText}
        </div>
        <div class="server-specs">${server.specs || ''}</div>
        ${isOnline ? `
        <div class="metrics">
          <div class="metric">
            <div class="metric-value">${server.cpu}%</div>
            <div class="metric-label">CPU</div>
          </div>
          <div class="metric">
            <div class="metric-value">${server.memory}%</div>
            <div class="metric-label">メモリ</div>
          </div>
          <div class="metric">
            <div class="metric-value">${server.gpu_temp === '-' ? '-' : server.gpu_temp + '°'}</div>
            <div class="metric-label">${server.name === 'Raspberry Pi' ? 'CPU温度' : 'GPU温度'}</div>
          </div>
        </div>
        ` : '<div class="metrics"><div class="metric"><div class="metric-value">-</div></div></div>'}
      </div>
    `;
  });

  html += '</div>';
  container.innerHTML = html;

  // Update time
  const updateTime = new Date(data.updated_at);
  const timeString = updateTime.toLocaleString('ja-JP');
  const now = new Date();
  const diffMinutes = (now - updateTime) / 1000 / 60;

  document.getElementById('update-time').textContent = `最終更新: ${timeString}`;

  const noteEl = document.getElementById('last-update-note');
  if (diffMinutes > 60) {
    noteEl.innerHTML = `<span style="color: #dc3545;">${timeString} ⚠️ 更新が停止しています</span>`;
  } else {
    noteEl.textContent = timeString;
  }
}

// Initial load
loadServerStatus();

// Auto refresh every 5 minutes
setInterval(loadServerStatus, 5 * 60 * 1000);
</script>
```

## サーバー情報

| マシン名 | 用途 | GPU |
|---------|------|-----|
| Al-Khwarizumi | メインサーバー（LLM環境等） | RTX 5070 Ti 16GB |
| Shimura | 計算用 | GTX 1660 SUPER 6GB |
| Taniyama | 計算用 | GTX 1660 SUPER 6GB |
| Seki | 計算用 | GTX 1660 SUPER 6GB |
| Raspberry Pi | 監視用 | - |

## 使い方

サーバーを利用したい場合は、[SSH接続ガイド](tech-guide/ssh-remote.html)を参照してください。
