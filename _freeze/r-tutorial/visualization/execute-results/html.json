{
  "hash": "0deb2d2a7f5efd06b7956a32d4925e01",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"可視化ギャラリー\"\n---\n\n\n\nこの章では、ggplot2で描ける様々な図を紹介します。「こんな図を描きたい！」と思ったら、対応するコードを参考にしてください。\n\n## ggplot2の基本構造\n\n```r\nggplot(data, aes(x = 変数1, y = 変数2)) +\n  geom_xxx()  # 図の種類\n```\n\n- `data`：使用するデータフレーム\n- `aes()`：軸や色などの「見た目」と変数の対応\n- `geom_xxx()`：図の種類（点、線、棒など）\n\n## 散布図\n\n2つの連続変数の関係を見る。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point() +\n  labs(x = \"排気量\", y = \"燃費（高速）\", title = \"散布図の例\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-2-1.png){width=576}\n:::\n:::\n\n\n### グループで色分け\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy, color = class)) +\n  geom_point() +\n  labs(x = \"排気量\", y = \"燃費（高速）\", color = \"車種\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### 回帰直線を追加\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point() +\n  geom_smooth(method = \"lm\") +\n  labs(x = \"排気量\", y = \"燃費（高速）\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-4-1.png){width=576}\n:::\n:::\n\n\n## ヒストグラム\n\n連続変数の分布を見る。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = hwy)) +\n  geom_histogram() +\n  labs(x = \"燃費（高速）\", y = \"度数\", title = \"ヒストグラムの例\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-5-1.png){width=576}\n:::\n:::\n\n\n### ビン幅を指定\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = hwy)) +\n  geom_histogram(binwidth = 2, fill = \"steelblue\", color = \"white\") +\n  labs(x = \"燃費（高速）\", y = \"度数\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-6-1.png){width=576}\n:::\n:::\n\n\n## 密度プロット\n\n分布を滑らかな曲線で表す。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = hwy)) +\n  geom_density(fill = \"steelblue\", alpha = 0.5) +\n  labs(x = \"燃費（高速）\", y = \"密度\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-7-1.png){width=576}\n:::\n:::\n\n\n### グループで比較\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = hwy, fill = drv)) +\n  geom_density(alpha = 0.5) +\n  labs(x = \"燃費（高速）\", y = \"密度\", fill = \"駆動方式\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## 棒グラフ\n\nカテゴリごとの度数や集計値を表す。\n\n### 度数\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = class)) +\n  geom_bar() +\n  labs(x = \"車種\", y = \"台数\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-9-1.png){width=576}\n:::\n:::\n\n\n### 集計値\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg |>\n  group_by(class) |>\n  summarize(mean_hwy = mean(hwy)) |>\n  ggplot(aes(x = reorder(class, mean_hwy), y = mean_hwy)) +\n  geom_col(fill = \"steelblue\") +\n  labs(x = \"車種\", y = \"平均燃費（高速）\") +\n  coord_flip()\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-10-1.png){width=576}\n:::\n:::\n\n\n## 箱ひげ図\n\nグループ間の分布を比較。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = class, y = hwy)) +\n  geom_boxplot() +\n  labs(x = \"車種\", y = \"燃費（高速）\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## バイオリンプロット\n\n箱ひげ図＋分布の形状。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = class, y = hwy)) +\n  geom_violin(fill = \"steelblue\", alpha = 0.5) +\n  geom_boxplot(width = 0.1) +\n  labs(x = \"車種\", y = \"燃費（高速）\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## 折れ線グラフ\n\n時系列や順序のあるデータ。\n\n\n::: {.cell}\n\n```{.r .cell-code}\neconomics |>\n  ggplot(aes(x = date, y = unemploy)) +\n  geom_line() +\n  labs(x = \"年\", y = \"失業者数（千人）\", title = \"アメリカの失業者数推移\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n## ファセット（小さな複数グラフ）\n\nグループごとに別々のパネルで表示。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(mpg, aes(x = displ, y = hwy)) +\n  geom_point() +\n  facet_wrap(~ class) +\n  labs(x = \"排気量\", y = \"燃費（高速）\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-14-1.png){width=768}\n:::\n:::\n\n\n## ヒートマップ\n\n2つのカテゴリ変数のクロス集計。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg |>\n  count(class, drv) |>\n  ggplot(aes(x = drv, y = class, fill = n)) +\n  geom_tile() +\n  geom_text(aes(label = n), color = \"white\") +\n  scale_fill_viridis_c() +\n  labs(x = \"駆動方式\", y = \"車種\", fill = \"台数\")\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n## 相関行列\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars |>\n  select(mpg, cyl, disp, hp, wt) |>\n  cor() |>\n  as.data.frame() |>\n  rownames_to_column(\"var1\") |>\n  pivot_longer(-var1, names_to = \"var2\", values_to = \"cor\") |>\n  ggplot(aes(x = var1, y = var2, fill = cor)) +\n  geom_tile() +\n  geom_text(aes(label = round(cor, 2))) +\n  scale_fill_gradient2(low = \"blue\", mid = \"white\", high = \"red\", midpoint = 0) +\n  labs(x = \"\", y = \"\", fill = \"相関係数\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](visualization_files/figure-html/unnamed-chunk-16-1.png){width=576}\n:::\n:::\n\n\n## 図の保存\n\n```r\n# 最後に描いた図を保存\nggsave(\"figure.png\", width = 6, height = 4, dpi = 300)\n\n# 特定の図を保存\np <- ggplot(mpg, aes(x = displ, y = hwy)) + geom_point()\nggsave(\"scatter.pdf\", plot = p, width = 6, height = 4)\n```\n\n## 次のステップ\n\n- [R Graph Gallery](https://r-graph-gallery.com/)：様々な図のコード例\n- [ggplot2公式リファレンス](https://ggplot2.tidyverse.org/reference/)\n- [Data to Viz](https://www.data-to-viz.com/)：データの種類から適切な図を選ぶ\n",
    "supporting": [
      "visualization_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}